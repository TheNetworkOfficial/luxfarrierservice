<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scheduling | Lux Farrier Service</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cleave.js/1.6.0/cleave.min.js"></script>
    <script src="../../components/js/phone-type-formatter.us.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Gideon+Roman&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Placeholder for Header -->
    <div id="header-placeholder"></div>

    <main>
      <section id="appointment-scheduling">
        <h2>Schedule an Appointment</h2>

        <form id="appointmentForm" enctype="multipart/form-data">
          
          <!-- ========== STEP 1: CLIENT INFO ========== -->
          <div class="form-step" id="step-1">
            <fieldset>
              <legend>Client Information</legend>
              
              <div class="form-row">
                <!-- Personal Information Column -->
                <div class="form-column">
                  <div class="form-group">
                    <label for="firstName">First Name:<span class="required-asterisk">*</span></label>
                    <input type="text" id="firstName" name="firstName" required />
                  </div>
                  
                  <div class="form-group">
                    <label for="lastName">Last Name:<span class="required-asterisk">*</span></label>
                    <input type="text" id="lastName" name="lastName" required />
                  </div>
                  
                  <div class="form-group">
                    <label for="clientPhone">Phone Number:<span class="required-asterisk">*</span></label>
                    <input type="tel" id="clientPhone" name="clientPhone" placeholder="(123) 456-7890" required />
                    <span id="phoneError" class="error-message">Please enter a valid 10-digit phone number.</span>
                  </div>
                  
                  <div class="form-group">
                    <label for="clientEmail">Email:<span class="required-asterisk">*</span></label>
                    <input type="email" id="clientEmail" name="clientEmail" required pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$" title="Please enter a valid email address." />
                    <span id="emailError" class="error-message">Please enter a valid email address.</span>
                  </div>
                </div><!-- End Personal Info Column -->
                
                <!-- Address Information Column -->
                <div class="form-column">
                  <div class="form-group">
                    <label for="streetAddress">Street Address (Location of horses if different):<span class="required-asterisk">*</span></label>
                    <input type="text" id="streetAddress" name="streetAddress" required list="address-suggestions" autocomplete="off" />
                    <datalist id="address-suggestions">
                      <!-- Options will be populated dynamically via JavaScript -->
                    </datalist>
                  </div>
                  
                  <div class="form-group">
                    <label for="city">City:<span class="required-asterisk">*</span></label>
                    <input type="text" id="city" name="city" required />
                  </div>
                  
                  <div class="form-group">
                    <label for="state">State:<span class="required-asterisk">*</span></label>
                    <select id="state" name="state" required>
                      <option value="" disabled selected>Select</option>
                      <!-- Add all US states here -->
                      <option value="AL">Alabama</option>
                      <option value="AK">Alaska</option>
                      <option value="AZ">Arizona</option>
                      <option value="AR">Arkansas</option>
                      <option value="CA">California</option>
                      <option value="CO">Colorado</option>
                      <option value="CT">Connecticut</option>
                      <option value="DE">Delaware</option>
                      <option value="FL">Florida</option>
                      <option value="GA">Georgia</option>
                      <option value="HI">Hawaii</option>
                      <option value="ID">Idaho</option>
                      <option value="IL">Illinois</option>
                      <option value="IN">Indiana</option>
                      <option value="IA">Iowa</option>
                      <option value="KS">Kansas</option>
                      <option value="KY">Kentucky</option>
                      <option value="LA">Louisiana</option>
                      <option value="ME">Maine</option>
                      <option value="MD">Maryland</option>
                      <option value="MA">Massachusetts</option>
                      <option value="MI">Michigan</option>
                      <option value="MN">Minnesota</option>
                      <option value="MS">Mississippi</option>
                      <option value="MO">Missouri</option>
                      <option value="MT">Montana</option>
                      <option value="NE">Nebraska</option>
                      <option value="NV">Nevada</option>
                      <option value="NH">New Hampshire</option>
                      <option value="NJ">New Jersey</option>
                      <option value="NM">New Mexico</option>
                      <option value="NY">New York</option>
                      <option value="NC">North Carolina</option>
                      <option value="ND">North Dakota</option>
                      <option value="OH">Ohio</option>
                      <option value="OK">Oklahoma</option>
                      <option value="OR">Oregon</option>
                      <option value="PA">Pennsylvania</option>
                      <option value="RI">Rhode Island</option>
                      <option value="SC">South Carolina</option>
                      <option value="SD">South Dakota</option>
                      <option value="TN">Tennessee</option>
                      <option value="TX">Texas</option>
                      <option value="UT">Utah</option>
                      <option value="VT">Vermont</option>
                      <option value="VA">Virginia</option>
                      <option value="WA">Washington</option>
                      <option value="WV">West Virginia</option>
                      <option value="WI">Wisconsin</option>
                      <option value="WY">Wyoming</option>
                    </select>
                  </div>
                  
                  <div class="form-group">
                    <label for="zip">ZIP Code:<span class="required-asterisk">*</span></label>
                    <input type="text" id="zip" name="zip" pattern="\d{5}" title="Please enter a 5-digit ZIP code." required />
                  </div>
                </div><!-- End Address Info Column -->
              </div><!-- End Form Row -->

              <!-- Navigation Buttons -->
              <div class="form-navigation">
                <button type="button" id="next-1" class="btn btn-next" disabled>
                  Next <i class="fas fa-arrow-right"></i>
                </button>
              </div>
            </fieldset>
          </div><!-- End Step 1 -->

          <!-- ========== STEP 2: HORSE INFO ========== -->
          <div class="form-step" id="step-2" style="display: none;">
            <fieldset>
              <legend>Horse Information</legend>

              <!-- Container for multiple horse blocks -->
              <div id="horse-info-container">
                <!-- One example block by default -->
                <div class="horse-info-block">
                  <!-- Remove button (top-right) -->
                  <button type="button" class="remove-horse-btn" title="Remove Horse"><i class="fas fa-times"></i></button>

                  <div class="horse-info-columns">
                    <div class="form-group">
                        <label>Name:<span class="required-asterisk">*</span></label>
                        <input type="text" name="horseName[]" required />
                    </div>
                
                    <div class="form-group">
                        <label>Breed:</label>
                        <input type="text" name="horseBreed[]" />
                    </div>
                
                    <div class="form-group">
                        <label>Age:</label>
                        <input type="number" name="horseAge[]" min="0" />
                    </div>
                
                    <div class="form-group">
                        <label>Sex:</label>
                        <select name="horseSex[]">
                            <option value="" disabled selected>Select</option>
                            <option value="Mare">Mare</option>
                            <option value="Gelding">Gelding</option>
                            <option value="Stallion">Stallion</option>
                        </select>
                    </div>
                
                    <div class="form-group">
                        <label>Occupation:<span class="required-asterisk">*</span></label>
                        <select name="horseOccupation[]" required>
                            <option value="" disabled selected>Select</option>
                            <option value="Working">Working</option>
                            <option value="Hunting / Packing">Hunting/Packing</option>
                            <option value="Jumping / Eventing">Jumping/Eventing</option>
                            <option value="Trail Riding">Trail Riding</option>
                            <option value="Retired / Pasture Pet">Retired/Pasture Pet</option>
                        </select>
                    </div>
                
                    <div class="form-group">
                        <label>Date of Last Farrier Care:<span class="required-asterisk">*</span></label>
                        <input type="date" name="horseLastCare[]" required />
                    </div>
                  </div>

                  <!-- Laminitis History? -->
                  <div class="form-group">
                    <label>History of Laminitis?:<span class="required-asterisk">*</span></label>
                    <select class="laminitis-history" name="laminitisHistory[]" required>
                      <option value="" disabled selected>Select</option>
                      <option value="No">No</option>
                      <option value="Yes">Yes</option>
                    </select>
                  </div>

                  <div class="conditional-group laminitis-details">
                    <div class="form-group">
                      <label>Is your horse currently in an active laminitic episode?:</label>
                      <select name="laminitisActive[]">
                        <option value="No" selected>No</option>
                        <option value="Yes">Yes</option>
                      </select>
                    </div>

                    <div class="form-group">
                      <label>Your horse's veterinarian (name/practice)?:</label>
                      <input type="text" name="laminitisVet[]" />
                    </div>

                    <div class="form-group">
                      <label>Do you have x-rays of the current laminitic episode?:</label>
                      <select class="laminitis-xray-select" name="laminitisXray[]">
                        <option value="No" selected>No</option>
                        <option value="Yes">Yes</option>
                      </select>
                    </div>

                    <div class="form-group conditional-group laminitis-xray-upload">
                      <label>Upload X-ray images:</label>
                      <input type="file" name="laminitisXrayFile[]" multiple accept="image/*" />
                    </div>
                  </div><!-- End Laminitis Details -->

                  <!-- Special farrier needs? -->
                  <div class="form-group">
                    <label>Any other (non-laminitic) known medical issues or special farrier needs?:<span class="required-asterisk">*</span></label>
                    <select class="special-needs-history" name="specialNeedsHistory[]" required>
                      <option value="" disabled selected>Select</option>
                      <option value="No">No</option>
                      <option value="Yes">Yes</option>
                    </select>
                  </div>

                  <div class="conditional-group special-needs-details">
                    <div class="form-group">
                      <label>Please explain your horse’s special needs:</label>
                      <textarea name="specialNeedsExplain[]" rows="2"></textarea>
                    </div>

                    <div class="form-group">
                      <label>Your horse's veterinarian (name/practice)?:</label>
                      <input type="text" name="specialNeedsVet[]" />
                    </div>

                    <div class="form-group">
                      <label>Do you have x-rays pertaining to this condition?:</label>
                      <select class="special-needs-xray-select" name="specialNeedsXray[]">
                        <option value="No" selected>No</option>
                        <option value="Yes">Yes</option>
                      </select>
                    </div>

                    <div class="form-group conditional-group special-needs-xray-upload">
                      <label>Upload X-ray images:</label>
                      <input type="file" name="specialNeedsXrayFile[]" multiple accept="image/*" />
                    </div>
                  </div><!-- End Special Needs Details -->

                </div><!-- End horse-info-block -->
              </div><!-- End #horse-info-container -->

              <!-- Buttons row: Add Horse + Next -->
              <div class="horse-btn-row">
                <button type="button" id="add-horse-btn" class="btn btn-add-horse">
                  <i class="fas fa-plus"></i> Add A Horse
                </button>
                <button type="button" id="next-2" class="btn btn-next" disabled>
                  Next <i class="fas fa-arrow-right"></i>
                </button>
              </div>
            </fieldset>
          </div><!-- End Step 2 -->

          <!-- ========== STEP 3: CALENDAR ========== -->
          <div class="form-step" id="step-3" style="display: none;">
            <fieldset>
              <legend>Choose Up To 3 Dates & Times</legend>

              <!-- Short instructions: make it very clear but not too long -->
              <p class="calendar-instructions">
                Please <strong>select up to 3 available slots</strong> below.
                One of these times will be confirmed within 24 hours. If you have any trouble, feel free to call us!
              </p>

              <!-- Container for the calendar app -->
              <div id="calendar-app">
                <div id="calendar-ui"></div>
              </div>

              <!-- Buttons row: Back + Next (now goes to new Step 4) -->
              <div class="form-navigation">
                <button type="button" id="back-3" class="btn btn-back">
                  <i class="fas fa-arrow-left"></i> Back
                </button>
                <!-- NEW: "Next" instead of "Submit". We'll go to Step 4. -->
                <button type="button" id="go-review" class="btn btn-next" disabled>
                  Review <i class="fas fa-arrow-right"></i>
                </button>
              </div>
            </fieldset>
          </div><!-- End Step 3 -->

          <!-- ========== STEP 4: REVIEW & SUBMIT (NEW) ========== -->
          <div class="form-step" id="step-4" style="display: none;">
            <fieldset>
              <legend>Review Your Details</legend>

              <div id="review-details">
                <!-- We'll populate this summary dynamically in appointmentForm.js -->
              </div>

              <!-- Buttons row: "Edit" (we'll have separate edit for each section) + "Submit" -->
              <div class="form-navigation">
                <button type="button" id="back-to-calendar" class="btn btn-back">
                  <i class="fas fa-arrow-left"></i> Edit Calendar
                </button>
                <!-- We might have additional edit buttons for steps 1 and 2 inside #review-details. -->

                <button type="submit" id="final-submit" class="btn btn-submit">
                  Submit <i class="fas fa-check"></i>
                </button>
              </div>
            </fieldset>
          </div><!-- End Step 4 -->

        </form>

        <!-- Disclaimer -->
        <p class="disclaimer">
          By requesting an appointment, you acknowledge that once confirmed, cancellations or rescheduling within 24 hours incur a $20 fee.
        </p>
      </section>
    </main>
      
    <!-- Placeholder for Footer -->
    <div id="footer-placeholder"></div>
  </body>
</html>